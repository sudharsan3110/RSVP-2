generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Users {
  id                          Int        @id @default(autoincrement())
  primary_email               String     @unique @db.VarChar(256)
  secondary_email             String?    @db.VarChar(256)
  contact                     String?    @db.VarChar(20)
  full_name                   String     @db.VarChar(256)
  magicToken                  String?    @unique @db.VarChar(256)
  is_completed                Boolean    @default(false)
  location                    String?    @db.VarChar(256)
  bio                         String?    @db.VarChar(512)
  twitter                     String?    @db.VarChar(256)
  instagram                   String?    @db.VarChar(256)
  website                     String?    @db.VarChar(256)
  profile_icon                String?    @db.VarChar(256)
  event_participation_enabled Boolean    @default(false)
  created_at                  DateTime   @default(now())
  updated_at                  DateTime   @default(now()) @updatedAt
  Event                       Event[]
  Attendee                    Attendee[]

  @@map("users")
}

model Update {
  id                        String    @id @default(uuid()) @db.VarChar(36)
  eventId                   String    @map("event_id") @db.VarChar(36)
  content                   String    @db.VarChar(512)
  createdAt                 DateTime  @map("created_at")
  updatedAt                 DateTime  @map("updated_at")
  isNotification            Boolean   @map("is_notification")
  scheduledNotificationTime DateTime? @map("scheduled_notification_time")
  event                     Event     @relation(fields: [eventId], references: [id])

  @@map("updates")
}

enum VenueType {
  physical
  virtual
}

model Event {
  id                     String     @id @default(uuid()) @db.VarChar(36)
  creatorId              Int        @map("creator_id")
  name                   String     @db.VarChar(256)
  category               String?    @db.VarChar(256)
  startTime              DateTime   @map("start_time")
  endTime                DateTime   @map("end_time")
  eventDate              DateTime   @map("event_date")
  description            String?    @db.VarChar(512)
  eventImageId           String?    @map("event_image_id") @db.VarChar(256)
  venueType              VenueType  @map("venue_type")
  venueAddress           String?    @map("venue_address") @db.VarChar(256)
  venueUrl               String?    @map("venue_url") @db.VarChar(256)
  hostPermissionRequired Boolean    @map("host_permission_required")
  capacity               Int?
  createdAt              DateTime   @default(now()) @map("created_at")
  updatedAt              DateTime   @updatedAt @map("updated_at")
  creator                Users      @relation(fields: [creatorId], references: [id])
  updates                Update[]
  Attendee               Attendee[]

  @@map("events")
}

model Attendee {
  id               String    @id @default(uuid()) @db.VarChar(36)
  userId           Int       @map("user_id")
  eventId          String    @map("event_id") @db.VarChar(36)
  registrationTime DateTime  @default(now()) @map("registration_time")
  hasAttended      Boolean   @map("has_attended") @default(false)
  checkInTime      DateTime? @map("check_in_time")
  feedback         String?   @db.VarChar(512)
  qrToken          String    @unique @db.VarChar(512)
  isAdmin          Boolean   @default(false)
  user             Users     @relation(fields: [userId], references: [id])
  event            Event     @relation(fields: [eventId], references: [id])

  @@map("attendees")
}